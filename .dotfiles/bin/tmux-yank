#!/usr/bin/env bash
# shellcheck disable=2016

for pane in $(tmux list-pane -a -F "#S:#I.#P"); do
    tmux capture-pane -t "$pane" -p
done |
    grep -P -o '((?:https?://|ftp://|news://|mailto:|file://|\bwww\.)[a-zA-Z0-9\-\@;\/?:&=%\$_.+!*\x27,~#]*(\([a-zA-Z0-9\-\@;\/?:&=%\$_.+!*\x27,~#]*\)|[a-zA-Z0-9\-\@;\/?:&=%\$_+*~])+)' |
    sort -u |
    fzf-tmux --cycle --no-multi \
        --header='(copy:enter) (open:ctrl-o)' \
        --bind "ctrl-o:execute(o {})+accept" |
    cb
